set auto_path "$auto_path /usr/share/tcltk/tcl8.6 /usr/share/tcltk /usr/lib /usr/local/lib/tcltk /usr/local/share/tcltk /usr/lib/tcltk/x86_64-linux-gnu /usr/lib/tcltk /usr/lib/tcltk/tcl8.6"
package require math
package require math::statistics

source /home/diegoa/dev/gridanalyzer/gridanalyzer_lib.tcl

set pdb_in "/media/diegoa/e3dc87ec-0db5-4583-8e37-c7b631804a37/backup-carreta0520/inv/parma/daniele/paper2217/bootstrapping/all.pdb"

set cutoff 0.5

global pdb_fh
set pdb_fh [ open "meanLIS_test.pdb" "w" ]


# Load PDB with LIS
set molID [ load_LIS_pdb $pdb_in ]

# LIS A1
set xyz_REF_list { {27.924000 34.550999 33.185001} {26.924000 33.550999 32.185001} {26.924000 34.550999 32.185001} {26.924000 34.550999 33.185001} }
set out_name "A1"
set is_file_open 0
LIS_selection $pdb_in $molID $xyz_REF_list $cutoff $out_name $pdb_fh

# LIS A2
set xyz_REF_list { { 22.924000 35.550999 31.184999 } { 23.924000 35.550999 31.184999 } { 23.995001 35.528000 31.538000 } }
set out_name "A2"
set is_file_open 1
LIS_selection $pdb_in $molID $xyz_REF_list $cutoff $out_name $pdb_fh

# LIS A3
set xyz_REF_list { { 18.924000 38.550999 33.185001 } { 18.995001 38.528000 33.537998 } { 19.924000 38.550999 32.185001 } { 19.924000 40.550999 33.185001 } { 18.924000 38.550999 32.185001 } { 19.924000 40.550999 33.185001 } { 19.924000 41.550999 32.185001 } { 20.924000 41.550999 31.184999 } { 18.924000 41.550999 33.185001 } { 18.924000 42.550999 32.185001 } { 18.924000 42.550999 33.185001 } { 17.924000 42.550999 33.185001 } { 17.924000 43.550999 32.185001 } { 17.995001 43.528000 32.537998 } { 17.924000 43.550999 33.185001 } { 18.924000 43.550999 31.184999 } { 19.924000 46.550999 35.185001 } }
set out_name "A3"
LIS_selection $pdb_in $molID $xyz_REF_list $cutoff $out_name $pdb_fh


# LIS B1
set xyz_REF_list { { 28.924000 28.551001 32.185001 } { 26.924000 28.551001 30.184999 } { 27.924000 29.551001 32.185001 } { 26.924000 29.551001 31.184999 } { 26.924000 29.551001 32.185001 } { 26.995001 29.528000 32.537998 } { 27.924000 31.551001 32.185001 } }
set out_name "B1"
LIS_selection $pdb_in $molID $xyz_REF_list $cutoff $out_name $pdb_fh

# LIS B2
set xyz_REF_list { { 29.924000 24.551001 30.184999 } { 29.995001 24.528000 30.538000 } }
set out_name "B2"
LIS_selection $pdb_in $molID $xyz_REF_list $cutoff $out_name $pdb_fh


# LIS B8
set xyz_REF_list { { 27.924000 30.551001 28.184999 } { 27.995001 30.528000 28.538000 } { 27.924000 30.551001 29.184999 } { 26.924000 30.551001 29.184999 } { 29.924000 28.551001 28.184999 } { 28.924000 29.551001 29.184999 } { 28.995001 28.528000 28.538000 } }
set out_name "B8"
LIS_selection $pdb_in $molID $xyz_REF_list $cutoff $out_name $pdb_fh


# LIS B9
set xyz_REF_list { { 32.924000 34.550999 24.184999 } { 32.924000 34.550999 23.184999 } { 32.924000 33.550999 23.184999 } { 35.924000 35.550999 24.184999 } { 35.994999 34.528000 23.538000 } { 35.924000 34.550999 23.184999 } { 33.924000 34.550999 24.184999 } { 33.994999 34.528000 23.538000 } { 33.924000 34.550999 23.184999 } { 35.924000 37.550999 25.184999 } { 35.924000 36.550999 25.184999 } { 35.924000 37.550999 24.184999 } { 35.924000 36.550999 24.184999 } { 36.924000 37.550999 24.184999 } }
set out_name "B9"
LIS_selection $pdb_in $molID $xyz_REF_list $cutoff $out_name $pdb_fh


# LIS B10
set xyz_REF_list { { 26.924000 35.550999 23.184999 } { 26.995001 36.528000 23.538000 } { 26.924000 36.550999 23.184999 } }
set out_name "B10"
LIS_selection $pdb_in $molID $xyz_REF_list $cutoff $out_name $pdb_fh


# LIS B6
set xyz_REF_list { { 34.994999 25.528000 33.537998 } { 34.924000 24.551001 34.185001 } { 33.924000 23.551001 34.185001 } { 34.924000 26.551001 32.185001 } { 34.924000 25.551001 32.185001 } { 34.924000 25.551001 33.185001 } { 34.924000 26.551001 31.184999 } }
set out_name "B6"
LIS_selection $pdb_in $molID $xyz_REF_list $cutoff $out_name $pdb_fh


# LIS B7
set xyz_REF_list { { 38.924000 26.551001 34.185001 } { 38.994999 26.528000 33.537998 } { 38.924000 26.551001 33.185001 } { 37.924000 26.551001 33.185001 } { 39.924000 25.551001 34.185001 } { 38.924000 25.551001 34.185001 } { 37.994999 25.528000 35.537998 } { 37.924000 25.551001 35.185001 } { 39.924000 26.551001 35.185001 } { 39.924000 25.551001 36.185001 } { 38.924000 25.551001 36.185001 } { 37.924000 25.551001 36.185001 } { 37.924000 26.551001 38.185001 } { 37.924000 26.551001 37.185001 } { 37.994999 26.528000 37.537998 } { 38.924000 26.551001 37.185001 } { 39.924000 27.551001 38.185001 } { 38.924000 27.551001 38.185001 } { 38.924000 27.551001 37.185001 } { 37.924000 27.551001 38.185001 } }
set out_name "B7"
LIS_selection $pdb_in $molID $xyz_REF_list $cutoff $out_name $pdb_fh


# LIS B3
set xyz_REF_list { { 28.924000 18.551001 28.184999 } { 28.995001 18.528000 28.538000 } { 28.924000 18.551001 29.184999 } { 28.924000 19.551001 30.184999 } { 28.924000 17.551001 28.184999 } }
set out_name "B3"
LIS_selection $pdb_in $molID $xyz_REF_list $cutoff $out_name $pdb_fh


# LIS B5
set xyz_REF_list { { 21.924000 15.551000 32.185001 } { 21.995001 16.528000 32.537998 } { 21.924000 16.551001 32.185001 } { 20.924000 15.551000 32.185001 } { 21.924000 14.551000 32.185001 } { 21.995001 14.528000 31.538000 } { 21.924000 15.551000 31.184999 } { 24.924000 15.551000 30.184999 } { 23.924000 15.551000 30.184999 } { 23.924000 14.551000 30.184999 } { 23.924000 14.551000 31.184999 } { 22.924000 14.551000 31.184999 } }
set out_name "B5"
LIS_selection $pdb_in $molID $xyz_REF_list $cutoff $out_name $pdb_fh



# LIS B4
set xyz_REF_list { { 31.995001 15.528000 23.538000 } { 31.924000 15.551000 25.184999 } { 31.995001 15.528000 25.538000 } { 32.924000 14.551000 23.184999 } { 31.924000 14.551000 23.184999 } { 32.924000 15.551000 23.184999 } { 31.924000 14.551000 22.184999 } { 34.924000 14.551000 24.184999 } { 33.924000 14.551000 23.184999 } { 33.924000 15.551000 23.184999 } { 34.924000 13.551000 25.184999 } { 35.924000 14.551000 25.184999 } { 34.924000 14.551000 25.184999 } { 34.994999 14.528000 24.538000 } { 35.924000 15.551000 25.184999 } { 35.924000 15.551000 23.184999 } { 35.924000 15.551000 24.184999 } { 34.924000 15.551000 24.184999 } { 34.924000 15.551000 23.184999 } { 35.924000 16.551001 23.184999 } { 34.924000 16.551001 23.184999 } { 33.924000 16.551001 23.184999 } { 35.924000 13.551000 24.184999 } { 34.924000 12.551000 26.184999 } { 33.924000 12.551000 25.184999 } { 34.994999 12.528000 25.538000 } { 34.924000 12.551000 25.184999 } }
set out_name "B4"
LIS_selection $pdb_in $molID $xyz_REF_list $cutoff $out_name $pdb_fh



# LIS C1
set xyz_REF_list { { 29.924000 37.550999 36.185001 } { 30.995001 36.528000 35.537998 } { 30.924000 36.550999 36.185001 } { 28.924000 36.550999 36.185001 } { 28.995001 36.528000 36.537998 } { 28.924000 37.550999 36.185001 } { 29.924000 37.550999 35.185001 } { 29.924000 35.550999 36.185001 } }
set out_name "C1"
LIS_selection $pdb_in $molID $xyz_REF_list $cutoff $out_name $pdb_fh



# LIS C4/5
set xyz_REF_list { { 28.924000 32.550999 38.185001 } { 27.924000 32.550999 38.185001 } { 27.924000 33.550999 38.185001 } { 28.924000 33.550999 38.185001 } { 28.924000 34.550999 38.185001 } { 30.924000 32.550999 38.185001 } { 29.924000 32.550999 38.185001 } { 29.995001 32.528000 38.537998 } { 29.924000 32.550999 39.185001 } { 30.995001 34.528000 38.537998 } { 30.924000 34.550999 39.185001 } { 31.924000 33.550999 39.185001 } }
set out_name "C4"
LIS_selection $pdb_in $molID $xyz_REF_list $cutoff $out_name $pdb_fh



# LIS C2
set xyz_REF_list { { 31.924000 38.550999 36.185001 } { 31.924000 39.550999 37.185001 } { 31.924000 39.550999 36.185001 } { 31.924000 38.550999 36.185001 } { 32.924000 40.550999 36.185001 } { 31.924000 40.550999 37.185001 } { 31.995001 40.528000 36.537998 } { 31.924000 40.550999 36.185001 } { 30.924000 40.550999 36.185001 } { 33.924000 42.550999 35.185001 } { 32.924000 42.550999 36.185001 } { 30.924000 41.550999 37.185001 } { 31.924000 41.550999 36.185001 } { 30.924000 41.550999 36.185001 } { 33.994999 40.528000 38.537998 } { 33.924000 40.550999 38.185001 } { 33.924000 40.550999 37.185001 } { 33.924000 40.550999 36.185001 } { 31.924000 41.550999 39.185001 } { 31.924000 40.550999 39.185001 } }
set out_name "C2"
LIS_selection $pdb_in $molID $xyz_REF_list $cutoff $out_name $pdb_fh



# LIS C3
set xyz_REF_list { { 34.924000 43.550999 40.185001 } { 34.924000 42.550999 41.185001 } { 34.994999 42.528000 40.537998 } { 36.994999 43.528000 39.537998 } { 36.924000 43.550999 39.185001 } { 37.924000 42.550999 40.185001 } { 37.924000 44.550999 40.185001 } { 36.924000 44.550999 40.185001 } }
set out_name "C3"
LIS_selection $pdb_in $molID $xyz_REF_list $cutoff $out_name $pdb_fh

close $pdb_fh

#load_LIS_pdb2 "meanLIS.pdb" 1.0

set molID [ mol new "meanLIS.pdb" type pdb autobonds off ]
mol modstyle 0 $molID VDW 0.1 12.0000
mol modmaterial 0 $molID AOChalky

set natoms [molinfo top get numatoms]
for {set i 0} {$i < $natoms} {incr i} {
	set sel [atomselect top "index $i"]
	set stdev [$sel get occupancy]
	set energy [$sel get beta]

	mol selection "index $i"
	mol representation VDW $stdev 12.000000
        mol material Transparent
	mol color Beta
	mol addrep top
}


mol off 0
set mid [ mol new "2217_10C_frame0.pdb" type pdb ]
color Display Background white
mol selection "protein"
mol representation NewCartoon
mol color Structure
mol modstyle 0 $mid NewCartoon 0.300000 12.000000 2.120000 0
mol addrep top
###
mol selection "resname HEM"
mol representation Licorice
mol color Name
mol addrep top
###



